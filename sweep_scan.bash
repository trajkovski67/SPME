#!/usr/bin/env bash

# stop on errors
set -eu

# put the name of your program here
program=./pme
# unique pattern to find the final energy
pattern='total electrostatic'
# output file for plotting
datafile=plot.dat

# scan distances
start_distance=32
last_distance=512
step=1

read -r -d 'END' input <<EOF
\NaCl
53.300000 53.300000 53.300000
90.0 90.0 90.0
1000
0.100000 0.100000 0.100000 1
0.000000 0.000000 0.100000 1
0.000000 0.100000 0.000000 1
0.100000 0.000000 0.000000 1
0.000000 0.000000 0.000000 -1
0.100000 0.100000 0.000000 -1
0.100000 0.000000 0.100000 -1
0.000000 0.100000 0.100000 -1
0.100000 0.100000 0.300000 1
0.000000 0.000000 0.300000 1
0.000000 0.100000 0.200000 1
0.100000 0.000000 0.200000 1
0.000000 0.000000 0.200000 -1
0.100000 0.100000 0.200000 -1
0.100000 0.000000 0.300000 -1
0.000000 0.100000 0.300000 -1
0.100000 0.100000 0.500000 1
0.000000 0.000000 0.500000 1
0.000000 0.100000 0.400000 1
0.100000 0.000000 0.400000 1
0.000000 0.000000 0.400000 -1
0.100000 0.100000 0.400000 -1
0.100000 0.000000 0.500000 -1
0.000000 0.100000 0.500000 -1
0.100000 0.100000 0.700000 1
0.000000 0.000000 0.700000 1
0.000000 0.100000 0.600000 1
0.100000 0.000000 0.600000 1
0.000000 0.000000 0.600000 -1
0.100000 0.100000 0.600000 -1
0.100000 0.000000 0.700000 -1
0.000000 0.100000 0.700000 -1
0.100000 0.100000 0.900000 1
0.000000 0.000000 0.900000 1
0.000000 0.100000 0.800000 1
0.100000 0.000000 0.800000 1
0.000000 0.000000 0.800000 -1
0.100000 0.100000 0.800000 -1
0.100000 0.000000 0.900000 -1
0.000000 0.100000 0.900000 -1
0.100000 0.300000 0.100000 1
0.000000 0.200000 0.100000 1
0.000000 0.300000 0.000000 1
0.100000 0.200000 0.000000 1
0.000000 0.200000 0.000000 -1
0.100000 0.300000 0.000000 -1
0.100000 0.200000 0.100000 -1
0.000000 0.300000 0.100000 -1
0.100000 0.300000 0.300000 1
0.000000 0.200000 0.300000 1
0.000000 0.300000 0.200000 1
0.100000 0.200000 0.200000 1
0.000000 0.200000 0.200000 -1
0.100000 0.300000 0.200000 -1
0.100000 0.200000 0.300000 -1
0.000000 0.300000 0.300000 -1
0.100000 0.300000 0.500000 1
0.000000 0.200000 0.500000 1
0.000000 0.300000 0.400000 1
0.100000 0.200000 0.400000 1
0.000000 0.200000 0.400000 -1
0.100000 0.300000 0.400000 -1
0.100000 0.200000 0.500000 -1
0.000000 0.300000 0.500000 -1
0.100000 0.300000 0.700000 1
0.000000 0.200000 0.700000 1
0.000000 0.300000 0.600000 1
0.100000 0.200000 0.600000 1
0.000000 0.200000 0.600000 -1
0.100000 0.300000 0.600000 -1
0.100000 0.200000 0.700000 -1
0.000000 0.300000 0.700000 -1
0.100000 0.300000 0.900000 1
0.000000 0.200000 0.900000 1
0.000000 0.300000 0.800000 1
0.100000 0.200000 0.800000 1
0.000000 0.200000 0.800000 -1
0.100000 0.300000 0.800000 -1
0.100000 0.200000 0.900000 -1
0.000000 0.300000 0.900000 -1
0.100000 0.500000 0.100000 1
0.000000 0.400000 0.100000 1
0.000000 0.500000 0.000000 1
0.100000 0.400000 0.000000 1
0.000000 0.400000 0.000000 -1
0.100000 0.500000 0.000000 -1
0.100000 0.400000 0.100000 -1
0.000000 0.500000 0.100000 -1
0.100000 0.500000 0.300000 1
0.000000 0.400000 0.300000 1
0.000000 0.500000 0.200000 1
0.100000 0.400000 0.200000 1
0.000000 0.400000 0.200000 -1
0.100000 0.500000 0.200000 -1
0.100000 0.400000 0.300000 -1
0.000000 0.500000 0.300000 -1
0.100000 0.500000 0.500000 1
0.000000 0.400000 0.500000 1
0.000000 0.500000 0.400000 1
0.100000 0.400000 0.400000 1
0.000000 0.400000 0.400000 -1
0.100000 0.500000 0.400000 -1
0.100000 0.400000 0.500000 -1
0.000000 0.500000 0.500000 -1
0.100000 0.500000 0.700000 1
0.000000 0.400000 0.700000 1
0.000000 0.500000 0.600000 1
0.100000 0.400000 0.600000 1
0.000000 0.400000 0.600000 -1
0.100000 0.500000 0.600000 -1
0.100000 0.400000 0.700000 -1
0.000000 0.500000 0.700000 -1
0.100000 0.500000 0.900000 1
0.000000 0.400000 0.900000 1
0.000000 0.500000 0.800000 1
0.100000 0.400000 0.800000 1
0.000000 0.400000 0.800000 -1
0.100000 0.500000 0.800000 -1
0.100000 0.400000 0.900000 -1
0.000000 0.500000 0.900000 -1
0.100000 0.700000 0.100000 1
0.000000 0.600000 0.100000 1
0.000000 0.700000 0.000000 1
0.100000 0.600000 0.000000 1
0.000000 0.600000 0.000000 -1
0.100000 0.700000 0.000000 -1
0.100000 0.600000 0.100000 -1
0.000000 0.700000 0.100000 -1
0.100000 0.700000 0.300000 1
0.000000 0.600000 0.300000 1
0.000000 0.700000 0.200000 1
0.100000 0.600000 0.200000 1
0.000000 0.600000 0.200000 -1
0.100000 0.700000 0.200000 -1
0.100000 0.600000 0.300000 -1
0.000000 0.700000 0.300000 -1
0.100000 0.700000 0.500000 1
0.000000 0.600000 0.500000 1
0.000000 0.700000 0.400000 1
0.100000 0.600000 0.400000 1
0.000000 0.600000 0.400000 -1
0.100000 0.700000 0.400000 -1
0.100000 0.600000 0.500000 -1
0.000000 0.700000 0.500000 -1
0.100000 0.700000 0.700000 1
0.000000 0.600000 0.700000 1
0.000000 0.700000 0.600000 1
0.100000 0.600000 0.600000 1
0.000000 0.600000 0.600000 -1
0.100000 0.700000 0.600000 -1
0.100000 0.600000 0.700000 -1
0.000000 0.700000 0.700000 -1
0.100000 0.700000 0.900000 1
0.000000 0.600000 0.900000 1
0.000000 0.700000 0.800000 1
0.100000 0.600000 0.800000 1
0.000000 0.600000 0.800000 -1
0.100000 0.700000 0.800000 -1
0.100000 0.600000 0.900000 -1
0.000000 0.700000 0.900000 -1
0.100000 0.900000 0.100000 1
0.000000 0.800000 0.100000 1
0.000000 0.900000 0.000000 1
0.100000 0.800000 0.000000 1
0.000000 0.800000 0.000000 -1
0.100000 0.900000 0.000000 -1
0.100000 0.800000 0.100000 -1
0.000000 0.900000 0.100000 -1
0.100000 0.900000 0.300000 1
0.000000 0.800000 0.300000 1
0.000000 0.900000 0.200000 1
0.100000 0.800000 0.200000 1
0.000000 0.800000 0.200000 -1
0.100000 0.900000 0.200000 -1
0.100000 0.800000 0.300000 -1
0.000000 0.900000 0.300000 -1
0.100000 0.900000 0.500000 1
0.000000 0.800000 0.500000 1
0.000000 0.900000 0.400000 1
0.100000 0.800000 0.400000 1
0.000000 0.800000 0.400000 -1
0.100000 0.900000 0.400000 -1
0.100000 0.800000 0.500000 -1
0.000000 0.900000 0.500000 -1
0.100000 0.900000 0.700000 1
0.000000 0.800000 0.700000 1
0.000000 0.900000 0.600000 1
0.100000 0.800000 0.600000 1
0.000000 0.800000 0.600000 -1
0.100000 0.900000 0.600000 -1
0.100000 0.800000 0.700000 -1
0.000000 0.900000 0.700000 -1
0.100000 0.900000 0.900000 1
0.000000 0.800000 0.900000 1
0.000000 0.900000 0.800000 1
0.100000 0.800000 0.800000 1
0.000000 0.800000 0.800000 -1
0.100000 0.900000 0.800000 -1
0.100000 0.800000 0.900000 -1
0.000000 0.900000 0.900000 -1
0.300000 0.100000 0.100000 1
0.200000 0.000000 0.100000 1
0.200000 0.100000 0.000000 1
0.300000 0.000000 0.000000 1
0.200000 0.000000 0.000000 -1
0.300000 0.100000 0.000000 -1
0.300000 0.000000 0.100000 -1
0.200000 0.100000 0.100000 -1
0.300000 0.100000 0.300000 1
0.200000 0.000000 0.300000 1
0.200000 0.100000 0.200000 1
0.300000 0.000000 0.200000 1
0.200000 0.000000 0.200000 -1
0.300000 0.100000 0.200000 -1
0.300000 0.000000 0.300000 -1
0.200000 0.100000 0.300000 -1
0.300000 0.100000 0.500000 1
0.200000 0.000000 0.500000 1
0.200000 0.100000 0.400000 1
0.300000 0.000000 0.400000 1
0.200000 0.000000 0.400000 -1
0.300000 0.100000 0.400000 -1
0.300000 0.000000 0.500000 -1
0.200000 0.100000 0.500000 -1
0.300000 0.100000 0.700000 1
0.200000 0.000000 0.700000 1
0.200000 0.100000 0.600000 1
0.300000 0.000000 0.600000 1
0.200000 0.000000 0.600000 -1
0.300000 0.100000 0.600000 -1
0.300000 0.000000 0.700000 -1
0.200000 0.100000 0.700000 -1
0.300000 0.100000 0.900000 1
0.200000 0.000000 0.900000 1
0.200000 0.100000 0.800000 1
0.300000 0.000000 0.800000 1
0.200000 0.000000 0.800000 -1
0.300000 0.100000 0.800000 -1
0.300000 0.000000 0.900000 -1
0.200000 0.100000 0.900000 -1
0.300000 0.300000 0.100000 1
0.200000 0.200000 0.100000 1
0.200000 0.300000 0.000000 1
0.300000 0.200000 0.000000 1
0.200000 0.200000 0.000000 -1
0.300000 0.300000 0.000000 -1
0.300000 0.200000 0.100000 -1
0.200000 0.300000 0.100000 -1
0.300000 0.300000 0.300000 1
0.200000 0.200000 0.300000 1
0.200000 0.300000 0.200000 1
0.300000 0.200000 0.200000 1
0.200000 0.200000 0.200000 -1
0.300000 0.300000 0.200000 -1
0.300000 0.200000 0.300000 -1
0.200000 0.300000 0.300000 -1
0.300000 0.300000 0.500000 1
0.200000 0.200000 0.500000 1
0.200000 0.300000 0.400000 1
0.300000 0.200000 0.400000 1
0.200000 0.200000 0.400000 -1
0.300000 0.300000 0.400000 -1
0.300000 0.200000 0.500000 -1
0.200000 0.300000 0.500000 -1
0.300000 0.300000 0.700000 1
0.200000 0.200000 0.700000 1
0.200000 0.300000 0.600000 1
0.300000 0.200000 0.600000 1
0.200000 0.200000 0.600000 -1
0.300000 0.300000 0.600000 -1
0.300000 0.200000 0.700000 -1
0.200000 0.300000 0.700000 -1
0.300000 0.300000 0.900000 1
0.200000 0.200000 0.900000 1
0.200000 0.300000 0.800000 1
0.300000 0.200000 0.800000 1
0.200000 0.200000 0.800000 -1
0.300000 0.300000 0.800000 -1
0.300000 0.200000 0.900000 -1
0.200000 0.300000 0.900000 -1
0.300000 0.500000 0.100000 1
0.200000 0.400000 0.100000 1
0.200000 0.500000 0.000000 1
0.300000 0.400000 0.000000 1
0.200000 0.400000 0.000000 -1
0.300000 0.500000 0.000000 -1
0.300000 0.400000 0.100000 -1
0.200000 0.500000 0.100000 -1
0.300000 0.500000 0.300000 1
0.200000 0.400000 0.300000 1
0.200000 0.500000 0.200000 1
0.300000 0.400000 0.200000 1
0.200000 0.400000 0.200000 -1
0.300000 0.500000 0.200000 -1
0.300000 0.400000 0.300000 -1
0.200000 0.500000 0.300000 -1
0.300000 0.500000 0.500000 1
0.200000 0.400000 0.500000 1
0.200000 0.500000 0.400000 1
0.300000 0.400000 0.400000 1
0.200000 0.400000 0.400000 -1
0.300000 0.500000 0.400000 -1
0.300000 0.400000 0.500000 -1
0.200000 0.500000 0.500000 -1
0.300000 0.500000 0.700000 1
0.200000 0.400000 0.700000 1
0.200000 0.500000 0.600000 1
0.300000 0.400000 0.600000 1
0.200000 0.400000 0.600000 -1
0.300000 0.500000 0.600000 -1
0.300000 0.400000 0.700000 -1
0.200000 0.500000 0.700000 -1
0.300000 0.500000 0.900000 1
0.200000 0.400000 0.900000 1
0.200000 0.500000 0.800000 1
0.300000 0.400000 0.800000 1
0.200000 0.400000 0.800000 -1
0.300000 0.500000 0.800000 -1
0.300000 0.400000 0.900000 -1
0.200000 0.500000 0.900000 -1
0.300000 0.700000 0.100000 1
0.200000 0.600000 0.100000 1
0.200000 0.700000 0.000000 1
0.300000 0.600000 0.000000 1
0.200000 0.600000 0.000000 -1
0.300000 0.700000 0.000000 -1
0.300000 0.600000 0.100000 -1
0.200000 0.700000 0.100000 -1
0.300000 0.700000 0.300000 1
0.200000 0.600000 0.300000 1
0.200000 0.700000 0.200000 1
0.300000 0.600000 0.200000 1
0.200000 0.600000 0.200000 -1
0.300000 0.700000 0.200000 -1
0.300000 0.600000 0.300000 -1
0.200000 0.700000 0.300000 -1
0.300000 0.700000 0.500000 1
0.200000 0.600000 0.500000 1
0.200000 0.700000 0.400000 1
0.300000 0.600000 0.400000 1
0.200000 0.600000 0.400000 -1
0.300000 0.700000 0.400000 -1
0.300000 0.600000 0.500000 -1
0.200000 0.700000 0.500000 -1
0.300000 0.700000 0.700000 1
0.200000 0.600000 0.700000 1
0.200000 0.700000 0.600000 1
0.300000 0.600000 0.600000 1
0.200000 0.600000 0.600000 -1
0.300000 0.700000 0.600000 -1
0.300000 0.600000 0.700000 -1
0.200000 0.700000 0.700000 -1
0.300000 0.700000 0.900000 1
0.200000 0.600000 0.900000 1
0.200000 0.700000 0.800000 1
0.300000 0.600000 0.800000 1
0.200000 0.600000 0.800000 -1
0.300000 0.700000 0.800000 -1
0.300000 0.600000 0.900000 -1
0.200000 0.700000 0.900000 -1
0.300000 0.900000 0.100000 1
0.200000 0.800000 0.100000 1
0.200000 0.900000 0.000000 1
0.300000 0.800000 0.000000 1
0.200000 0.800000 0.000000 -1
0.300000 0.900000 0.000000 -1
0.300000 0.800000 0.100000 -1
0.200000 0.900000 0.100000 -1
0.300000 0.900000 0.300000 1
0.200000 0.800000 0.300000 1
0.200000 0.900000 0.200000 1
0.300000 0.800000 0.200000 1
0.200000 0.800000 0.200000 -1
0.300000 0.900000 0.200000 -1
0.300000 0.800000 0.300000 -1
0.200000 0.900000 0.300000 -1
0.300000 0.900000 0.500000 1
0.200000 0.800000 0.500000 1
0.200000 0.900000 0.400000 1
0.300000 0.800000 0.400000 1
0.200000 0.800000 0.400000 -1
0.300000 0.900000 0.400000 -1
0.300000 0.800000 0.500000 -1
0.200000 0.900000 0.500000 -1
0.300000 0.900000 0.700000 1
0.200000 0.800000 0.700000 1
0.200000 0.900000 0.600000 1
0.300000 0.800000 0.600000 1
0.200000 0.800000 0.600000 -1
0.300000 0.900000 0.600000 -1
0.300000 0.800000 0.700000 -1
0.200000 0.900000 0.700000 -1
0.300000 0.900000 0.900000 1
0.200000 0.800000 0.900000 1
0.200000 0.900000 0.800000 1
0.300000 0.800000 0.800000 1
0.200000 0.800000 0.800000 -1
0.300000 0.900000 0.800000 -1
0.300000 0.800000 0.900000 -1
0.200000 0.900000 0.900000 -1
0.500000 0.100000 0.100000 1
0.400000 0.000000 0.100000 1
0.400000 0.100000 0.000000 1
0.500000 0.000000 0.000000 1
0.400000 0.000000 0.000000 -1
0.500000 0.100000 0.000000 -1
0.500000 0.000000 0.100000 -1
0.400000 0.100000 0.100000 -1
0.500000 0.100000 0.300000 1
0.400000 0.000000 0.300000 1
0.400000 0.100000 0.200000 1
0.500000 0.000000 0.200000 1
0.400000 0.000000 0.200000 -1
0.500000 0.100000 0.200000 -1
0.500000 0.000000 0.300000 -1
0.400000 0.100000 0.300000 -1
0.500000 0.100000 0.500000 1
0.400000 0.000000 0.500000 1
0.400000 0.100000 0.400000 1
0.500000 0.000000 0.400000 1
0.400000 0.000000 0.400000 -1
0.500000 0.100000 0.400000 -1
0.500000 0.000000 0.500000 -1
0.400000 0.100000 0.500000 -1
0.500000 0.100000 0.700000 1
0.400000 0.000000 0.700000 1
0.400000 0.100000 0.600000 1
0.500000 0.000000 0.600000 1
0.400000 0.000000 0.600000 -1
0.500000 0.100000 0.600000 -1
0.500000 0.000000 0.700000 -1
0.400000 0.100000 0.700000 -1
0.500000 0.100000 0.900000 1
0.400000 0.000000 0.900000 1
0.400000 0.100000 0.800000 1
0.500000 0.000000 0.800000 1
0.400000 0.000000 0.800000 -1
0.500000 0.100000 0.800000 -1
0.500000 0.000000 0.900000 -1
0.400000 0.100000 0.900000 -1
0.500000 0.300000 0.100000 1
0.400000 0.200000 0.100000 1
0.400000 0.300000 0.000000 1
0.500000 0.200000 0.000000 1
0.400000 0.200000 0.000000 -1
0.500000 0.300000 0.000000 -1
0.500000 0.200000 0.100000 -1
0.400000 0.300000 0.100000 -1
0.500000 0.300000 0.300000 1
0.400000 0.200000 0.300000 1
0.400000 0.300000 0.200000 1
0.500000 0.200000 0.200000 1
0.400000 0.200000 0.200000 -1
0.500000 0.300000 0.200000 -1
0.500000 0.200000 0.300000 -1
0.400000 0.300000 0.300000 -1
0.500000 0.300000 0.500000 1
0.400000 0.200000 0.500000 1
0.400000 0.300000 0.400000 1
0.500000 0.200000 0.400000 1
0.400000 0.200000 0.400000 -1
0.500000 0.300000 0.400000 -1
0.500000 0.200000 0.500000 -1
0.400000 0.300000 0.500000 -1
0.500000 0.300000 0.700000 1
0.400000 0.200000 0.700000 1
0.400000 0.300000 0.600000 1
0.500000 0.200000 0.600000 1
0.400000 0.200000 0.600000 -1
0.500000 0.300000 0.600000 -1
0.500000 0.200000 0.700000 -1
0.400000 0.300000 0.700000 -1
0.500000 0.300000 0.900000 1
0.400000 0.200000 0.900000 1
0.400000 0.300000 0.800000 1
0.500000 0.200000 0.800000 1
0.400000 0.200000 0.800000 -1
0.500000 0.300000 0.800000 -1
0.500000 0.200000 0.900000 -1
0.400000 0.300000 0.900000 -1
0.500000 0.500000 0.100000 1
0.400000 0.400000 0.100000 1
0.400000 0.500000 0.000000 1
0.500000 0.400000 0.000000 1
0.400000 0.400000 0.000000 -1
0.500000 0.500000 0.000000 -1
0.500000 0.400000 0.100000 -1
0.400000 0.500000 0.100000 -1
0.500000 0.500000 0.300000 1
0.400000 0.400000 0.300000 1
0.400000 0.500000 0.200000 1
0.500000 0.400000 0.200000 1
0.400000 0.400000 0.200000 -1
0.500000 0.500000 0.200000 -1
0.500000 0.400000 0.300000 -1
0.400000 0.500000 0.300000 -1
0.500000 0.500000 0.500000 1
0.400000 0.400000 0.500000 1
0.400000 0.500000 0.400000 1
0.500000 0.400000 0.400000 1
0.400000 0.400000 0.400000 -1
0.500000 0.500000 0.400000 -1
0.500000 0.400000 0.500000 -1
0.400000 0.500000 0.500000 -1
0.500000 0.500000 0.700000 1
0.400000 0.400000 0.700000 1
0.400000 0.500000 0.600000 1
0.500000 0.400000 0.600000 1
0.400000 0.400000 0.600000 -1
0.500000 0.500000 0.600000 -1
0.500000 0.400000 0.700000 -1
0.400000 0.500000 0.700000 -1
0.500000 0.500000 0.900000 1
0.400000 0.400000 0.900000 1
0.400000 0.500000 0.800000 1
0.500000 0.400000 0.800000 1
0.400000 0.400000 0.800000 -1
0.500000 0.500000 0.800000 -1
0.500000 0.400000 0.900000 -1
0.400000 0.500000 0.900000 -1
0.500000 0.700000 0.100000 1
0.400000 0.600000 0.100000 1
0.400000 0.700000 0.000000 1
0.500000 0.600000 0.000000 1
0.400000 0.600000 0.000000 -1
0.500000 0.700000 0.000000 -1
0.500000 0.600000 0.100000 -1
0.400000 0.700000 0.100000 -1
0.500000 0.700000 0.300000 1
0.400000 0.600000 0.300000 1
0.400000 0.700000 0.200000 1
0.500000 0.600000 0.200000 1
0.400000 0.600000 0.200000 -1
0.500000 0.700000 0.200000 -1
0.500000 0.600000 0.300000 -1
0.400000 0.700000 0.300000 -1
0.500000 0.700000 0.500000 1
0.400000 0.600000 0.500000 1
0.400000 0.700000 0.400000 1
0.500000 0.600000 0.400000 1
0.400000 0.600000 0.400000 -1
0.500000 0.700000 0.400000 -1
0.500000 0.600000 0.500000 -1
0.400000 0.700000 0.500000 -1
0.500000 0.700000 0.700000 1
0.400000 0.600000 0.700000 1
0.400000 0.700000 0.600000 1
0.500000 0.600000 0.600000 1
0.400000 0.600000 0.600000 -1
0.500000 0.700000 0.600000 -1
0.500000 0.600000 0.700000 -1
0.400000 0.700000 0.700000 -1
0.500000 0.700000 0.900000 1
0.400000 0.600000 0.900000 1
0.400000 0.700000 0.800000 1
0.500000 0.600000 0.800000 1
0.400000 0.600000 0.800000 -1
0.500000 0.700000 0.800000 -1
0.500000 0.600000 0.900000 -1
0.400000 0.700000 0.900000 -1
0.500000 0.900000 0.100000 1
0.400000 0.800000 0.100000 1
0.400000 0.900000 0.000000 1
0.500000 0.800000 0.000000 1
0.400000 0.800000 0.000000 -1
0.500000 0.900000 0.000000 -1
0.500000 0.800000 0.100000 -1
0.400000 0.900000 0.100000 -1
0.500000 0.900000 0.300000 1
0.400000 0.800000 0.300000 1
0.400000 0.900000 0.200000 1
0.500000 0.800000 0.200000 1
0.400000 0.800000 0.200000 -1
0.500000 0.900000 0.200000 -1
0.500000 0.800000 0.300000 -1
0.400000 0.900000 0.300000 -1
0.500000 0.900000 0.500000 1
0.400000 0.800000 0.500000 1
0.400000 0.900000 0.400000 1
0.500000 0.800000 0.400000 1
0.400000 0.800000 0.400000 -1
0.500000 0.900000 0.400000 -1
0.500000 0.800000 0.500000 -1
0.400000 0.900000 0.500000 -1
0.500000 0.900000 0.700000 1
0.400000 0.800000 0.700000 1
0.400000 0.900000 0.600000 1
0.500000 0.800000 0.600000 1
0.400000 0.800000 0.600000 -1
0.500000 0.900000 0.600000 -1
0.500000 0.800000 0.700000 -1
0.400000 0.900000 0.700000 -1
0.500000 0.900000 0.900000 1
0.400000 0.800000 0.900000 1
0.400000 0.900000 0.800000 1
0.500000 0.800000 0.800000 1
0.400000 0.800000 0.800000 -1
0.500000 0.900000 0.800000 -1
0.500000 0.800000 0.900000 -1
0.400000 0.900000 0.900000 -1
0.700000 0.100000 0.100000 1
0.600000 0.000000 0.100000 1
0.600000 0.100000 0.000000 1
0.700000 0.000000 0.000000 1
0.600000 0.000000 0.000000 -1
0.700000 0.100000 0.000000 -1
0.700000 0.000000 0.100000 -1
0.600000 0.100000 0.100000 -1
0.700000 0.100000 0.300000 1
0.600000 0.000000 0.300000 1
0.600000 0.100000 0.200000 1
0.700000 0.000000 0.200000 1
0.600000 0.000000 0.200000 -1
0.700000 0.100000 0.200000 -1
0.700000 0.000000 0.300000 -1
0.600000 0.100000 0.300000 -1
0.700000 0.100000 0.500000 1
0.600000 0.000000 0.500000 1
0.600000 0.100000 0.400000 1
0.700000 0.000000 0.400000 1
0.600000 0.000000 0.400000 -1
0.700000 0.100000 0.400000 -1
0.700000 0.000000 0.500000 -1
0.600000 0.100000 0.500000 -1
0.700000 0.100000 0.700000 1
0.600000 0.000000 0.700000 1
0.600000 0.100000 0.600000 1
0.700000 0.000000 0.600000 1
0.600000 0.000000 0.600000 -1
0.700000 0.100000 0.600000 -1
0.700000 0.000000 0.700000 -1
0.600000 0.100000 0.700000 -1
0.700000 0.100000 0.900000 1
0.600000 0.000000 0.900000 1
0.600000 0.100000 0.800000 1
0.700000 0.000000 0.800000 1
0.600000 0.000000 0.800000 -1
0.700000 0.100000 0.800000 -1
0.700000 0.000000 0.900000 -1
0.600000 0.100000 0.900000 -1
0.700000 0.300000 0.100000 1
0.600000 0.200000 0.100000 1
0.600000 0.300000 0.000000 1
0.700000 0.200000 0.000000 1
0.600000 0.200000 0.000000 -1
0.700000 0.300000 0.000000 -1
0.700000 0.200000 0.100000 -1
0.600000 0.300000 0.100000 -1
0.700000 0.300000 0.300000 1
0.600000 0.200000 0.300000 1
0.600000 0.300000 0.200000 1
0.700000 0.200000 0.200000 1
0.600000 0.200000 0.200000 -1
0.700000 0.300000 0.200000 -1
0.700000 0.200000 0.300000 -1
0.600000 0.300000 0.300000 -1
0.700000 0.300000 0.500000 1
0.600000 0.200000 0.500000 1
0.600000 0.300000 0.400000 1
0.700000 0.200000 0.400000 1
0.600000 0.200000 0.400000 -1
0.700000 0.300000 0.400000 -1
0.700000 0.200000 0.500000 -1
0.600000 0.300000 0.500000 -1
0.700000 0.300000 0.700000 1
0.600000 0.200000 0.700000 1
0.600000 0.300000 0.600000 1
0.700000 0.200000 0.600000 1
0.600000 0.200000 0.600000 -1
0.700000 0.300000 0.600000 -1
0.700000 0.200000 0.700000 -1
0.600000 0.300000 0.700000 -1
0.700000 0.300000 0.900000 1
0.600000 0.200000 0.900000 1
0.600000 0.300000 0.800000 1
0.700000 0.200000 0.800000 1
0.600000 0.200000 0.800000 -1
0.700000 0.300000 0.800000 -1
0.700000 0.200000 0.900000 -1
0.600000 0.300000 0.900000 -1
0.700000 0.500000 0.100000 1
0.600000 0.400000 0.100000 1
0.600000 0.500000 0.000000 1
0.700000 0.400000 0.000000 1
0.600000 0.400000 0.000000 -1
0.700000 0.500000 0.000000 -1
0.700000 0.400000 0.100000 -1
0.600000 0.500000 0.100000 -1
0.700000 0.500000 0.300000 1
0.600000 0.400000 0.300000 1
0.600000 0.500000 0.200000 1
0.700000 0.400000 0.200000 1
0.600000 0.400000 0.200000 -1
0.700000 0.500000 0.200000 -1
0.700000 0.400000 0.300000 -1
0.600000 0.500000 0.300000 -1
0.700000 0.500000 0.500000 1
0.600000 0.400000 0.500000 1
0.600000 0.500000 0.400000 1
0.700000 0.400000 0.400000 1
0.600000 0.400000 0.400000 -1
0.700000 0.500000 0.400000 -1
0.700000 0.400000 0.500000 -1
0.600000 0.500000 0.500000 -1
0.700000 0.500000 0.700000 1
0.600000 0.400000 0.700000 1
0.600000 0.500000 0.600000 1
0.700000 0.400000 0.600000 1
0.600000 0.400000 0.600000 -1
0.700000 0.500000 0.600000 -1
0.700000 0.400000 0.700000 -1
0.600000 0.500000 0.700000 -1
0.700000 0.500000 0.900000 1
0.600000 0.400000 0.900000 1
0.600000 0.500000 0.800000 1
0.700000 0.400000 0.800000 1
0.600000 0.400000 0.800000 -1
0.700000 0.500000 0.800000 -1
0.700000 0.400000 0.900000 -1
0.600000 0.500000 0.900000 -1
0.700000 0.700000 0.100000 1
0.600000 0.600000 0.100000 1
0.600000 0.700000 0.000000 1
0.700000 0.600000 0.000000 1
0.600000 0.600000 0.000000 -1
0.700000 0.700000 0.000000 -1
0.700000 0.600000 0.100000 -1
0.600000 0.700000 0.100000 -1
0.700000 0.700000 0.300000 1
0.600000 0.600000 0.300000 1
0.600000 0.700000 0.200000 1
0.700000 0.600000 0.200000 1
0.600000 0.600000 0.200000 -1
0.700000 0.700000 0.200000 -1
0.700000 0.600000 0.300000 -1
0.600000 0.700000 0.300000 -1
0.700000 0.700000 0.500000 1
0.600000 0.600000 0.500000 1
0.600000 0.700000 0.400000 1
0.700000 0.600000 0.400000 1
0.600000 0.600000 0.400000 -1
0.700000 0.700000 0.400000 -1
0.700000 0.600000 0.500000 -1
0.600000 0.700000 0.500000 -1
0.700000 0.700000 0.700000 1
0.600000 0.600000 0.700000 1
0.600000 0.700000 0.600000 1
0.700000 0.600000 0.600000 1
0.600000 0.600000 0.600000 -1
0.700000 0.700000 0.600000 -1
0.700000 0.600000 0.700000 -1
0.600000 0.700000 0.700000 -1
0.700000 0.700000 0.900000 1
0.600000 0.600000 0.900000 1
0.600000 0.700000 0.800000 1
0.700000 0.600000 0.800000 1
0.600000 0.600000 0.800000 -1
0.700000 0.700000 0.800000 -1
0.700000 0.600000 0.900000 -1
0.600000 0.700000 0.900000 -1
0.700000 0.900000 0.100000 1
0.600000 0.800000 0.100000 1
0.600000 0.900000 0.000000 1
0.700000 0.800000 0.000000 1
0.600000 0.800000 0.000000 -1
0.700000 0.900000 0.000000 -1
0.700000 0.800000 0.100000 -1
0.600000 0.900000 0.100000 -1
0.700000 0.900000 0.300000 1
0.600000 0.800000 0.300000 1
0.600000 0.900000 0.200000 1
0.700000 0.800000 0.200000 1
0.600000 0.800000 0.200000 -1
0.700000 0.900000 0.200000 -1
0.700000 0.800000 0.300000 -1
0.600000 0.900000 0.300000 -1
0.700000 0.900000 0.500000 1
0.600000 0.800000 0.500000 1
0.600000 0.900000 0.400000 1
0.700000 0.800000 0.400000 1
0.600000 0.800000 0.400000 -1
0.700000 0.900000 0.400000 -1
0.700000 0.800000 0.500000 -1
0.600000 0.900000 0.500000 -1
0.700000 0.900000 0.700000 1
0.600000 0.800000 0.700000 1
0.600000 0.900000 0.600000 1
0.700000 0.800000 0.600000 1
0.600000 0.800000 0.600000 -1
0.700000 0.900000 0.600000 -1
0.700000 0.800000 0.700000 -1
0.600000 0.900000 0.700000 -1
0.700000 0.900000 0.900000 1
0.600000 0.800000 0.900000 1
0.600000 0.900000 0.800000 1
0.700000 0.800000 0.800000 1
0.600000 0.800000 0.800000 -1
0.700000 0.900000 0.800000 -1
0.700000 0.800000 0.900000 -1
0.600000 0.900000 0.900000 -1
0.900000 0.100000 0.100000 1
0.800000 0.000000 0.100000 1
0.800000 0.100000 0.000000 1
0.900000 0.000000 0.000000 1
0.800000 0.000000 0.000000 -1
0.900000 0.100000 0.000000 -1
0.900000 0.000000 0.100000 -1
0.800000 0.100000 0.100000 -1
0.900000 0.100000 0.300000 1
0.800000 0.000000 0.300000 1
0.800000 0.100000 0.200000 1
0.900000 0.000000 0.200000 1
0.800000 0.000000 0.200000 -1
0.900000 0.100000 0.200000 -1
0.900000 0.000000 0.300000 -1
0.800000 0.100000 0.300000 -1
0.900000 0.100000 0.500000 1
0.800000 0.000000 0.500000 1
0.800000 0.100000 0.400000 1
0.900000 0.000000 0.400000 1
0.800000 0.000000 0.400000 -1
0.900000 0.100000 0.400000 -1
0.900000 0.000000 0.500000 -1
0.800000 0.100000 0.500000 -1
0.900000 0.100000 0.700000 1
0.800000 0.000000 0.700000 1
0.800000 0.100000 0.600000 1
0.900000 0.000000 0.600000 1
0.800000 0.000000 0.600000 -1
0.900000 0.100000 0.600000 -1
0.900000 0.000000 0.700000 -1
0.800000 0.100000 0.700000 -1
0.900000 0.100000 0.900000 1
0.800000 0.000000 0.900000 1
0.800000 0.100000 0.800000 1
0.900000 0.000000 0.800000 1
0.800000 0.000000 0.800000 -1
0.900000 0.100000 0.800000 -1
0.900000 0.000000 0.900000 -1
0.800000 0.100000 0.900000 -1
0.900000 0.300000 0.100000 1
0.800000 0.200000 0.100000 1
0.800000 0.300000 0.000000 1
0.900000 0.200000 0.000000 1
0.800000 0.200000 0.000000 -1
0.900000 0.300000 0.000000 -1
0.900000 0.200000 0.100000 -1
0.800000 0.300000 0.100000 -1
0.900000 0.300000 0.300000 1
0.800000 0.200000 0.300000 1
0.800000 0.300000 0.200000 1
0.900000 0.200000 0.200000 1
0.800000 0.200000 0.200000 -1
0.900000 0.300000 0.200000 -1
0.900000 0.200000 0.300000 -1
0.800000 0.300000 0.300000 -1
0.900000 0.300000 0.500000 1
0.800000 0.200000 0.500000 1
0.800000 0.300000 0.400000 1
0.900000 0.200000 0.400000 1
0.800000 0.200000 0.400000 -1
0.900000 0.300000 0.400000 -1
0.900000 0.200000 0.500000 -1
0.800000 0.300000 0.500000 -1
0.900000 0.300000 0.700000 1
0.800000 0.200000 0.700000 1
0.800000 0.300000 0.600000 1
0.900000 0.200000 0.600000 1
0.800000 0.200000 0.600000 -1
0.900000 0.300000 0.600000 -1
0.900000 0.200000 0.700000 -1
0.800000 0.300000 0.700000 -1
0.900000 0.300000 0.900000 1
0.800000 0.200000 0.900000 1
0.800000 0.300000 0.800000 1
0.900000 0.200000 0.800000 1
0.800000 0.200000 0.800000 -1
0.900000 0.300000 0.800000 -1
0.900000 0.200000 0.900000 -1
0.800000 0.300000 0.900000 -1
0.900000 0.500000 0.100000 1
0.800000 0.400000 0.100000 1
0.800000 0.500000 0.000000 1
0.900000 0.400000 0.000000 1
0.800000 0.400000 0.000000 -1
0.900000 0.500000 0.000000 -1
0.900000 0.400000 0.100000 -1
0.800000 0.500000 0.100000 -1
0.900000 0.500000 0.300000 1
0.800000 0.400000 0.300000 1
0.800000 0.500000 0.200000 1
0.900000 0.400000 0.200000 1
0.800000 0.400000 0.200000 -1
0.900000 0.500000 0.200000 -1
0.900000 0.400000 0.300000 -1
0.800000 0.500000 0.300000 -1
0.900000 0.500000 0.500000 1
0.800000 0.400000 0.500000 1
0.800000 0.500000 0.400000 1
0.900000 0.400000 0.400000 1
0.800000 0.400000 0.400000 -1
0.900000 0.500000 0.400000 -1
0.900000 0.400000 0.500000 -1
0.800000 0.500000 0.500000 -1
0.900000 0.500000 0.700000 1
0.800000 0.400000 0.700000 1
0.800000 0.500000 0.600000 1
0.900000 0.400000 0.600000 1
0.800000 0.400000 0.600000 -1
0.900000 0.500000 0.600000 -1
0.900000 0.400000 0.700000 -1
0.800000 0.500000 0.700000 -1
0.900000 0.500000 0.900000 1
0.800000 0.400000 0.900000 1
0.800000 0.500000 0.800000 1
0.900000 0.400000 0.800000 1
0.800000 0.400000 0.800000 -1
0.900000 0.500000 0.800000 -1
0.900000 0.400000 0.900000 -1
0.800000 0.500000 0.900000 -1
0.900000 0.700000 0.100000 1
0.800000 0.600000 0.100000 1
0.800000 0.700000 0.000000 1
0.900000 0.600000 0.000000 1
0.800000 0.600000 0.000000 -1
0.900000 0.700000 0.000000 -1
0.900000 0.600000 0.100000 -1
0.800000 0.700000 0.100000 -1
0.900000 0.700000 0.300000 1
0.800000 0.600000 0.300000 1
0.800000 0.700000 0.200000 1
0.900000 0.600000 0.200000 1
0.800000 0.600000 0.200000 -1
0.900000 0.700000 0.200000 -1
0.900000 0.600000 0.300000 -1
0.800000 0.700000 0.300000 -1
0.900000 0.700000 0.500000 1
0.800000 0.600000 0.500000 1
0.800000 0.700000 0.400000 1
0.900000 0.600000 0.400000 1
0.800000 0.600000 0.400000 -1
0.900000 0.700000 0.400000 -1
0.900000 0.600000 0.500000 -1
0.800000 0.700000 0.500000 -1
0.900000 0.700000 0.700000 1
0.800000 0.600000 0.700000 1
0.800000 0.700000 0.600000 1
0.900000 0.600000 0.600000 1
0.800000 0.600000 0.600000 -1
0.900000 0.700000 0.600000 -1
0.900000 0.600000 0.700000 -1
0.800000 0.700000 0.700000 -1
0.900000 0.700000 0.900000 1
0.800000 0.600000 0.900000 1
0.800000 0.700000 0.800000 1
0.900000 0.600000 0.800000 1
0.800000 0.600000 0.800000 -1
0.900000 0.700000 0.800000 -1
0.900000 0.600000 0.900000 -1
0.800000 0.700000 0.900000 -1
0.900000 0.900000 0.100000 1
0.800000 0.800000 0.100000 1
0.800000 0.900000 0.000000 1
0.900000 0.800000 0.000000 1
0.800000 0.800000 0.000000 -1
0.900000 0.900000 0.000000 -1
0.900000 0.800000 0.100000 -1
0.800000 0.900000 0.100000 -1
0.900000 0.900000 0.300000 1
0.800000 0.800000 0.300000 1
0.800000 0.900000 0.200000 1
0.900000 0.800000 0.200000 1
0.800000 0.800000 0.200000 -1
0.900000 0.900000 0.200000 -1
0.900000 0.800000 0.300000 -1
0.800000 0.900000 0.300000 -1
0.900000 0.900000 0.500000 1
0.800000 0.800000 0.500000 1
0.800000 0.900000 0.400000 1
0.900000 0.800000 0.400000 1
0.800000 0.800000 0.400000 -1
0.900000 0.900000 0.400000 -1
0.900000 0.800000 0.500000 -1
0.800000 0.900000 0.500000 -1
0.900000 0.900000 0.700000 1
0.800000 0.800000 0.700000 1
0.800000 0.900000 0.600000 1
0.900000 0.800000 0.600000 1
0.800000 0.800000 0.600000 -1
0.900000 0.900000 0.600000 -1
0.900000 0.800000 0.700000 -1
0.800000 0.900000 0.700000 -1
0.900000 0.900000 0.900000 1
0.800000 0.800000 0.900000 1
0.800000 0.900000 0.800000 1
0.900000 0.800000 0.800000 1
0.800000 0.800000 0.800000 -1
0.900000 0.900000 0.800000 -1
0.900000 0.800000 0.900000 -1
0.800000 0.900000 0.900000 -1
DIST DIST DIST 
\0.5 8 0 0
END
EOF

tmpinp=temporary.inp
tmpout=temporary.out

# cleanup
[ -f $datafile ] && rm -v $datafile

steps=$(seq $start_distance $step $last_distance | wc -l)
printf "Scanning from %.3f %.3f in %d steps\n" \
   $start_distance $last_distance $steps

for distance in $(seq $start_distance $step $last_distance | sed s/,/./)
do
   # generate the input file
   echo "$input" | sed s/DIST/$distance/ > $tmpinp
   # perform the actual calculation on the input file
   2>&1 $program $tmpinp > $tmpout
   # get the energy from the program output
   energy=$(grep "$pattern" $tmpout | awk '{printf "%f",$(NF)}' | tail -1)
   # if there is no energy to be found, we complain
   if [ -z "$energy" ]
      then
         1>&2 printf "ERROR!\n"
         1>&2 printf "'%s' cannot be found in '%s' output\n" "$pattern" "$program"
         1>&2 printf "please inspect '%s' and '%s'\n" "$tmpinp" "$tmpout"
         exit 1
   fi
   # otherwise we write to the logfile
   printf "Current energy is %.8f Hartree for ewald coeff. %.3f \n" \
      $energy $distance
   printf "%8.3f %12.8f\n" $distance $energy >> $datafile
done

# cleanup
[ -f $tmpinp ] && rm $tmpinp
[ -f $tmpout ] && rm $tmpout

